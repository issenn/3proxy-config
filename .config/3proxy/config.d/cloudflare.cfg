# Cloudflare CDN

system "echo load Cloudflare CDN config!"


flush

auth iponly

allow * * 127.0.0.1/8 * HTTP,HTTPS,CONNECT
# parent 1000 http 0.0.0.0 0

allow * * 10.0.0.0/8,172.16.0.0/12,192.168.0.0/16 * HTTP,HTTPS,CONNECT


allow * * 1.1.1.0/24,1.0.0.0/24,173.245.48.0/20,103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17,162.158.0.0/15,104.16.0.0/13,104.24.0.0/14,172.64.0.0/17,172.64.128.0/18,172.64.192.0/19,172.64.224.0/22,172.64.229.0/24,172.64.230.0/23,172.64.232.0/21,172.64.240.0/21,172.64.248.0/21,172.65.0.0/16,172.66.0.0/16,172.67.0.0/16,131.0.72.0/22 443
parent 1000 tcp 172.64.153.158 443

allow * * 1.1.1.0/24,1.0.0.0/24,173.245.48.0/20,103.21.244.0/22,103.22.200.0/22,103.31.4.0/22,141.101.64.0/18,108.162.192.0/18,190.93.240.0/20,188.114.96.0/20,197.234.240.0/22,198.41.128.0/17,162.158.0.0/15,104.16.0.0/13,104.24.0.0/14,172.64.0.0/17,172.64.128.0/18,172.64.192.0/19,172.64.224.0/22,172.64.229.0/24,172.64.230.0/23,172.64.232.0/21,172.64.240.0/21,172.64.248.0/21,172.65.0.0/16,172.66.0.0/16,172.67.0.0/16,131.0.72.0/22 80
parent 1000 tcp 172.64.153.158 80

allow * * * * HTTP,HTTPS,CONNECT
parent 1000 socks5+ 127.0.0.1 10808

allow *

# proxy -n -p3130 -a
socks -n -p3131


flush


# C:\>CloudflareST.exe -h

# CloudflareSpeedTest vX.X.X
# 测试 Cloudflare CDN 所有 IP 的延迟和速度，获取最快 IP (IPv4+IPv6)！
# https://github.com/XIU2/CloudflareSpeedTest

# 参数：
#     -n 200
#         测速线程数量；越多测速越快，性能弱的设备 (如路由器) 请勿太高；(默认 200 最多 1000 )
#     -t 4
#         延迟测速次数；单个 IP 延迟测速次数，为 1 时将过滤丢包的IP，TCP协议；(默认 4 次)
#     -tp 443
#         指定测速端口；延迟测速/下载测速时使用的端口；(默认 443 端口)
#     -dn 10
#         下载测速数量；延迟测速并排序后，从最低延迟起下载测速的数量；(默认 10 个)
#     -dt 10
#         下载测速时间；单个 IP 下载测速最长时间，不能太短；(默认 10 秒)
#     -url https://cf.xiu2.xyz/url
#         下载测速地址；用来下载测速的 Cloudflare CDN 文件地址，默认地址不保证可用性，建议自建；
#     -tl 200
#         平均延迟上限；只输出低于指定平均延迟的 IP，可与其他上限/下限搭配；(默认 9999 ms)
#     -tll 40
#         平均延迟下限；只输出高于指定平均延迟的 IP，可与其他上限/下限搭配、过滤假墙 IP；(默认 0 ms)
#     -sl 5
#         下载速度下限；只输出高于指定下载速度的 IP，凑够指定数量 [-dn] 才会停止测速；(默认 0.00 MB/s)
#     -p 10
#         显示结果数量；测速后直接显示指定数量的结果，为 0 时不显示结果直接退出；(默认 10 个)
#     -f ip.txt
#         IP段数据文件；如路径含有空格请加上引号；支持其他 CDN IP段；(默认 ip.txt)
#     -o result.csv
#         写入结果文件；如路径含有空格请加上引号；值为空时不写入文件 [-o ""]；(默认 result.csv)
#     -dd
#         禁用下载测速；禁用后测速结果会按延迟排序 (默认按下载速度排序)；(默认 启用)
#     -ipv6
#         IPv6测速模式；确保 IP 段数据文件内只包含 IPv6 IP段，软件不支持同时测速 IPv4+IPv6；(默认 IPv4)
#     -allip
#         测速全部的IP；对 IP 段中的每个 IP (仅支持 IPv4) 进行测速；(默认 每个 IP 段随机测速一个 IP)
#     -v
#         打印程序版本+检查版本更新
#     -h
#         打印帮助说明

# CloudflareST -n 200 -t 4 -tp 443 -dn 30 -dt 30 -url https://speed.cloudflare.com/__down?bytes=500000000 -tl 200 -sl 5 -o " "
